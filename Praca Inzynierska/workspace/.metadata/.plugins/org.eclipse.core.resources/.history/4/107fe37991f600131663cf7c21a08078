package org.workbench.tool;

import java.awt.CardLayout;
import java.awt.GridLayout;
import java.awt.event.ActionEvent;
import java.awt.event.ActionListener;

import javax.swing.BorderFactory;
import javax.swing.BoxLayout;
import javax.swing.JButton;
import javax.swing.JLabel;
import javax.swing.JPanel;
import javax.swing.border.BevelBorder;

import org.w3c.dom.Document;
import org.w3c.dom.Element;
import org.workbench.tool.attributes.AttribList;
import org.workbench.tool.attributes.Attribute;

public class Tool extends AttribList implements ActionListener {
	private static ToolSetter setter = new ToolSetter();
	private String windowName;

	public Tool() {
		setter.setupTool(this);
	}

	JPanel getToolEditorPanel() {
		JPanel p = new JPanel();
		p.setBorder(BorderFactory.createTitledBorder(BorderFactory.createBevelBorder(BevelBorder.RAISED), "Setup new tool"));
		p.setLayout(new GridLayout(size(),1));
		for (Attribute a: this) {
			p.add(a.getAttributeEditPanel());
		}
		return p;
	}
	JPanel getToolValueEditorPanel() {
		JPanel p = new JPanel();
		p.setBorder(BorderFactory.createTitledBorder(BorderFactory.createBevelBorder(BevelBorder.RAISED), "Setup new tool"));
		p.setLayout(new GridLayout(size(),1));
		for (Attribute a: this) {
			if (!a.getType().equals("") || !a.getName().equals("")) p.add(a.getAttributeValueEditPanel());
		}
		return p;
	}


	@Override
	public void actionPerformed(ActionEvent e) {
		if (e.getActionCommand().equals("SAVE"))
			for (Attribute a:this) a.saveFromForm(e);
	}

	public void setWindowName (String name) {
		this.windowName=name;
	}
	
	public String getWindowName() {
		return windowName;
	}

	public void save(Element tools, Document doc) {
		Element tool = doc.createElement("tool");
		tools.appendChild(tool);
		tool.setAttribute("window", windowName);
		for (Attribute a:this)
			a.save(tool,doc);
	}

	public JPanel getMiniPanel() {
		JLabel label = new JLabel (this.get(0).getValue());
		JButton edit = new JButton ("edit");
		JPanel p = new JPanel ();
		p.setLayout(new BoxLayout (this,BoxLayout.Y_AXIS));
		p.add(label);
		p.add(edit);
		
		System.out.println (this.get(0).getValue());
		return p;
	}
	
}
